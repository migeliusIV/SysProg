# TODO list:
Конвертер из см в дюймы
- [x] Подключить c++ функцию в asm;
- [x] Реализовать остальную часть asm файла до cpp-режима;
- [ ] Обработать ввод и вывод в с++ функции и передать управление на asm;
  
Дюйм = 2,54 * см

# Теормин:
## c++ extrn
1. Важен порядок линковки объектных файлов, первым должен идти "основной" файл, в данном случае, ассемблерный, затем cpp-шный и последним - файл для работы с моделью памяти (от модели памяти зависит расположение программы на стеке => способ обращения к функциям);
```bat
tasm /l /zi /c /ov:\labs\lab5\lab5.asm v:\labs\lab5\lab5.obj
tlink /m /v /l /Lv:\bc\lib v:\labs\lab5\lab5.obj v:\labs\lab5\lab5_cpp.obj v:\bc\lib\c0l.obj ,lab5.exe,,cl.lib mathl.lib emu.lib
```
2. Для компиляции среде разработки необходимо указывать её реальный корневой каталог, чтобы при компиляции путь к dll'кам и .lib'ам кастомизировался;
3. С проблемами с++ ввода и вывода данных так и не разобрался, этот ишак находит какие-то перегрузки operator>>... Приходится писать на си (Толику привет);
4. Можно писать код по turbo debugger'у, он раскладывает с++ код на ассемблерные команды, включая FPU-шные.

## Прочее полезное
**OFFSET** arr — вычисляет адрес, по которому хранится строка;
* В одном файле возможно использовать сегменты другого (для этого нужно вместо ``mov ax, @data`` использовать ``mov ax, /c data.asm``);
* **Адресное пространство** - память, с которой в один момент может работать процессор;
* Если ОЗУ заполнится, операционная система может решить, что пора выгрузить неактивные страницы этого процесса на NVMe, чтобы освободить место для других процессов. MMU обновляет таблицы страниц, чтобы отображать виртуальные адреса этих выгруженных страниц на NVMe;
* https://al-tm.ru/stati/stati-po-setyam/fizicheskaya-i-virtualnaya-pamyat-kompyuterov-%28likbez%29 - чилл;
* https://habr.com/ru/articles/128991/ - звездануться можно;
* https://www.cyberforum.ru/assembler/thread1005284.html

```x86asm
; Замена команды jmp near ptr
db 0Fh, 84h                   ; Код операции для JE near (вручную)
dw offset END_PROG - ($ + 2)  ; 16-битное смещение
```
Когда в 80286 добавили JE near, свободных однобайтовых кодов уже не осталось. **Решение**: использовать префикс 0Fh для расширения набора команд.
Таким образом:
- 0Fh — сигнал процессору: "следующий байт — расширенная команда".
- 84h — код условного перехода JE near.
- dup - однотипные данные

# FPU 

# Оптимизация .asm
### Оптимизация программ на языке ассемблера**
Итак ваша программа заработала, а теперь постарайтесь переделать ее так, чтобы она стала максимально компактной и в тоже время максимально быстродействующей.
Такая оптимизация достигается в три этапа:
* Алгоритмическая оптимизация то есть подбор алгоритма, который выполняет вашу задачу более быстрым способом и позволит сократить не пять, а пятьдесят операторов;
* Подстройка программы под конкретное оборудование;
* Замена некоторых ассемблерных команд на машинный код. Тщательный анализ машинного кода, вырабатываемого транслятором, позволяют прийти к выводу, что некоторые коды человек может выработать более оптимально, чем программа.

### style
1. После каждой строки, где меняется значение регистра, указывать в комментарии, что в этом регистре;
2. Отступы делать не просто для циклов и ветвлений, но и для выделения любых ресурсов;
3. Для больших проектов начинать имена функций с префиксов, определяющих к какой подсистеме или даже модулю относится функция. Например, если это модуль работы со связными списками, то функции вполне могут называться linked_list.create, linked_list.free, linked_list.push, linked_list.first и так далее. Это добавляет накладные на набор имён, но упрощает понимание любого кода, использующего модуль для работы со связными списками, и соответственно его последующую модификацию;
4. Структуризация проекта. Проект нужно делить на функции, модули (файлы), пакеты (папки) и подсистемы (опять папки). Хотя совсем маленьким проектикам до 5-10 тыс. строк вполне хватит только разделения на модули. В заголовочные inc-файлы нужно включать только определения, не генерирующие код. Функции должны находиться только в asm-файлах;
5. Старайтесь не использовать прописные буквы с мнемониками инструкций и именами регистров.