DTSEG SEGMENT PARA 'DATA' 
    MES0 DB "╧ЁютхЁюўэ√щ ЄхъёЄ - 20", 0Dh, 0Ah, '$' 
    MES1 DB "???л?? ????????? лл??? ?????? - `???? ???????`", 0Dh, 0Ah, '$' 
    MES2 DB "???????????? ???-л? ????? - 10", 0Dh, 0Ah, '$' 
    MES3 DB "???л?? ????????? лл??? ????? - *", 0Dh, 0Ah, '$' 
    BUF_SYMBS DB 40 DUP(?)  
    HEX_TABLE DB '0123456789ABCDEF'
    BUF_CX DW ?
    ROW_SYMBS DW 40
    ROWS DW 10 
DTSEG ENDS

STSEG SEGMENT PARA 'STACK' 
    DB 200 DUP(0) 
STSEG ENDS 

CDSEG SEGMENT PARA 'CODE' 
    ASSUME DS:DTSEG, SS:STSEG, CS:CDSEG 

MAIN PROC 
    MOV AX, DTSEG 
    MOV DS, AX 
    ; ??л?? ????л????? ?????????. 
    MOV DX, OFFSET MES0 
    CALL PUTMES 
    MOV DX, OFFSET MES1 
    CALL PUTMES 
    MOV DX, OFFSET MES2 
    CALL PUTMES 
    MOV DX, OFFSET MES3 
    CALL PUTMES 
    CALL CLRF 
    MOV BX, OFFSET HEX_TABLE 
    MOV CX, ROWS  ; ??????? ??? ????? LOOP0. 
    ; ???? ?? ???????
    LOOP0: 
    ; ???? лл??? ?????. 
    MOV BUF_CX, CX 
    MOV CX, ROW_SYMBS  ; ??????? ??? ????? LOOP1. 
    MOV SI, 0  ; ??????? ???л??????? ??????. 
    
LOOP1: 
; ???? лл??? ????? ??????. 
    CALL GETCH  ; ?л?? ???л???. 
    ; ???л???? ????????? лл??? ?????. 
    CMP AL, '*' 
    JE GO0 
    ; ???л???? ????????? лл??? ??????. 
    CMP AL, '$' 
    JE GO0 
    MOV BUF_SYMBS[SI], AL  ; ?????? ?????????? ???л??? л ???л?????? ?????. 
    INC SI 
    LOOP LOOP1 
GO0: 
; 
; ???л????, ??? ?????? ?????? ??? ?л?????? ???????? (лл???? ???л?? "*" 
    CMP SI, 0 
    JE GO1 
    ; ?л?л?? ?????? " = ". 
    CALL PUTSPACE 
    MOV DL, 3DH 
    ; л?л?? ???л??? ??????? 
    CALL PUTCH 
    CALL PUTSPACE 
    MOV CX, SI  ; ??????? ??? ????? LOOP2 (??л?? ???-л? лл??????? ;???л???л). 
    MOV SI, 0  ; ??????? ???л??????? ??????. 

;???? ?????? ? ?????????л???? 
LOOP2: 
    ; ???? ?????????л???? ???л???л лл?????? ??????. 
    MOV AL, BUF_SYMBS[SI]  ; ?????? ???л??? ?? ???л??????? ??????. 
    INC SI 
    CALL HEX  ; ??????????л?? ? ??????
    ;?????? 
    CALL PUTSPACE 
    ; ????? ????? л?л??? ?? ??????
    LOOP LOOP2 

GO1: 
    ; ???л????, ??? лл??????? ?????? ?л?????? ????????. 
    CMP AL, '*' 
    JE END_PROG 
    
    CALL CLRF 
    ; ??? ????? лл??? ?????? 
    MOV CX, BUF_CX 
    ; ????? ????? лл??? ?????
    LOOP LOOP0 
    
END_PROG: 
    ; ??л??????? ?????? ?????????. 
    
    MOV AH, 4CH 
    INT 21H 
MAIN ENDP 
;????????? ?????????
PUTCH PROC 
    ; ????????? л?л??? ???л???. 
    MOV AH, 02H 
    INT 21H 
    RET 
PUTCH ENDP 

PUTSPACE PROC 
    ; ????????? л?л??? ???????. 
    MOV DL, 20H 
    MOV AH, 02H 
    INT 21H 
    RET 
PUTSPACE ENDP 

PUTMES PROC 
    ; ????????? л?л??? ??????л??? ?????????. 
    MOV AH, 09H 
    INT 21H 
    RET 
PUTMES ENDP 

CLRF PROC 
    ; ????????? ????л??? ?????? ? л??л???? ???????. 
    MOV AH, 02H 
    MOV DL, 0AH 
    INT 21H 
    MOV DL, 0DH 
    INT 21H 
    RET 
CLRF ENDP 

GETCH PROC 
    ; ????????? лл??? ???л???. 
    MOV AH, 01H 
    INT 21H 
    RET 
GETCH ENDP 

HEX PROC 
    ; ????????? ??????????л?? 
    PUSH AX 
    ; ???????? ???????? ???????? ?????????. 
    MOV DL, AL 
    SHR DL, 4 
    MOV AL, DL 
    XLAT 
    ; ??л???? ???????? ???????? ?????????. 
    MOV DL, AL 
    CALL PUTCH 
    ; ???????? ???????? ???????? ?????????. 
    POP AX 
    MOV DL, AL 
    SHL DL, 4 
    SHR DL, 4 
    MOV AL, DL 
    XLAT 
    ; ??л???? ???????? ???????? ?????????. 
    MOV DL, AL 
    CALL PUTCH 
    RET 
HEX ENDP  

CDSEG ENDS 
 
END MAIN